<!DOCTYPE HTML>
<html lang>
<head>
<!-- Generated by javadoc (21) on Tue Dec 17 12:28:48 CET 2024 -->
<title>ExtendedSignServiceIntegrationService (SignService Integration API - 2.3.0)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2024-12-17">
<meta name="description" content="declaration: package: se.idsec.signservice.integration, interface: ExtendedSignServiceIntegrationService">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../script-dir/jquery-ui.min.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var pathtoroot = "../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/ExtendedSignServiceIntegrationService.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html#class">Help</a></li>
</ul>
<ul class="sub-nav-list-small">
<li>
<p>Summary:</p>
<ul>
<li>Nested</li>
<li>Field</li>
<li>Constr</li>
<li><a href="#method-summary">Method</a></li>
</ul>
</li>
<li>
<p>Detail:</p>
<ul>
<li>Field</li>
<li>Constr</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</li>
</ul>
</div>
<div class="sub-nav">
<div id="navbar-sub-list">
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><a href="../../../../search.html">SEARCH</a>
<input type="text" id="search-input" disabled placeholder="Search">
<input type="reset" id="reset-button" disabled value="reset">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">se.idsec.signservice.integration</a></div>
<h1 title="Interface ExtendedSignServiceIntegrationService" class="title">Interface ExtendedSignServiceIntegrationService</h1>
</div>
<section class="class-description" id="class-description">
<dl class="notes">
<dt>All Superinterfaces:</dt>
<dd><code><a href="SignServiceIntegrationService.html" title="interface in se.idsec.signservice.integration">SignServiceIntegrationService</a></code></dd>
</dl>
<hr>
<div class="type-signature"><span class="modifiers">public interface </span><span class="element-name type-name-label">ExtendedSignServiceIntegrationService</span><span class="extends-implements">
extends <a href="SignServiceIntegrationService.html" title="interface in se.idsec.signservice.integration">SignServiceIntegrationService</a></span></div>
<div class="block">An extension to the interface describing the API for the SignService Integration Service.

 <p>
 This extension is optional to implement, but its purpose is to supply the user of the API with utility methods that
 are useful during signature processing.
 </p></div>
<dl class="notes">
<dt>Author:</dt>
<dd>Martin Lindstr√∂m (martin@idsec.se), Stefan Santesson (stefan@idsec.se)</dd>
</dl>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab3" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab3', 3)" class="table-tab">Abstract Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="document/pdf/PreparedPdfDocument.html" title="class in se.idsec.signservice.integration.document.pdf">PreparedPdfDocument</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#preparePdfDocument(java.lang.String,byte%5B%5D,se.idsec.signservice.integration.document.pdf.PdfSignaturePagePreferences,java.lang.Boolean,java.lang.String)" class="member-name-link">preparePdfDocument</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;policy,
 byte[]&nbsp;pdfDocument,
 <a href="document/pdf/PdfSignaturePagePreferences.html" title="class in se.idsec.signservice.integration.document.pdf">PdfSignaturePagePreferences</a>&nbsp;signaturePagePreferences,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Boolean.html" title="class or interface in java.lang" class="external-link">Boolean</a>&nbsp;returnDocumentReference,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;callerId)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">A utility method that can be used to prepare a PDF document for signing.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-se.idsec.signservice.integration.SignServiceIntegrationService">Methods inherited from interface&nbsp;se.idsec.signservice.integration.<a href="SignServiceIntegrationService.html" title="interface in se.idsec.signservice.integration">SignServiceIntegrationService</a></h3>
<code><a href="SignServiceIntegrationService.html#createSignRequest(se.idsec.signservice.integration.SignRequestInput)">createSignRequest</a>, <a href="SignServiceIntegrationService.html#createSignRequest(se.idsec.signservice.integration.SignRequestInput,java.lang.String)">createSignRequest</a>, <a href="SignServiceIntegrationService.html#getConfiguration(java.lang.String)">getConfiguration</a>, <a href="SignServiceIntegrationService.html#getPolicies()">getPolicies</a>, <a href="SignServiceIntegrationService.html#getVersion()">getVersion</a>, <a href="SignServiceIntegrationService.html#processSignResponse(java.lang.String,java.lang.String,se.idsec.signservice.integration.core.SignatureState,se.idsec.signservice.integration.SignResponseProcessingParameters)">processSignResponse</a>, <a href="SignServiceIntegrationService.html#processSignResponse(java.lang.String,java.lang.String,se.idsec.signservice.integration.core.SignatureState,se.idsec.signservice.integration.SignResponseProcessingParameters,java.lang.String)">processSignResponse</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="preparePdfDocument(java.lang.String,byte[],se.idsec.signservice.integration.document.pdf.PdfSignaturePagePreferences,java.lang.Boolean,java.lang.String)">
<h3>preparePdfDocument</h3>
<div class="member-signature"><span class="return-type"><a href="document/pdf/PreparedPdfDocument.html" title="class in se.idsec.signservice.integration.document.pdf">PreparedPdfDocument</a></span>&nbsp;<span class="element-name">preparePdfDocument</span><wbr><span class="parameters">(@Nullable
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;policy,
 @Nonnull
 byte[]&nbsp;pdfDocument,
 @Nullable
 <a href="document/pdf/PdfSignaturePagePreferences.html" title="class in se.idsec.signservice.integration.document.pdf">PdfSignaturePagePreferences</a>&nbsp;signaturePagePreferences,
 @Nullable
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Boolean.html" title="class or interface in java.lang" class="external-link">Boolean</a>&nbsp;returnDocumentReference,
 @Nullable
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;callerId)</span>
                                throws <span class="exceptions"><a href="core/error/InputValidationException.html" title="class in se.idsec.signservice.integration.core.error">InputValidationException</a>,
<a href="document/pdf/PdfSignaturePageFullException.html" title="class in se.idsec.signservice.integration.document.pdf">PdfSignaturePageFullException</a>,
<a href="document/pdf/PdfAConsistencyCheckException.html" title="class in se.idsec.signservice.integration.document.pdf">PdfAConsistencyCheckException</a>,
<a href="document/pdf/PdfContainsAcroformException.html" title="class in se.idsec.signservice.integration.document.pdf">PdfContainsAcroformException</a>,
<a href="document/pdf/PdfContainsEncryptionDictionaryException.html" title="class in se.idsec.signservice.integration.document.pdf">PdfContainsEncryptionDictionaryException</a>,
<a href="core/error/SignServiceIntegrationException.html" title="class in se.idsec.signservice.integration.core.error">SignServiceIntegrationException</a></span></div>
<div class="block">A utility method that can be used to prepare a PDF document for signing.
 <p>
 The main purpose is to prepare a document that is to be signed with a PDF signature page holding the signature
 image(s), but the method may also be used to ensure that the document is correct with respect to its format, and
 also have the document "fixed" (see below).
 </p>
 <b>Signature pages and visible signatures</b>
 <p>
 A PDF signature image can be inserted into a signed PDF document to make the signature information "visible". The
 image along with the coordinates that tell where in the PDF document the image should be inserted is represented
 using a <a href="document/pdf/VisiblePdfSignatureRequirement.html" title="class in se.idsec.signservice.integration.document.pdf"><code>VisiblePdfSignatureRequirement</code></a> object. See
 <a href="document/TbsDocument.html#getVisiblePdfSignatureRequirement()"><code>TbsDocument.getVisiblePdfSignatureRequirement()</code></a>.
 </p>
 <p>
 However, for the generic case, where we may not always know how the PDF document that we are signing looks like it
 may be tricky to determine where in the document the PDF signature image should be inserted. For those cases, a
 dedicated "PDF signature page" may be added to the PDF document before it is added to a <a href="document/TbsDocument.html" title="class in se.idsec.signservice.integration.document"><code>TbsDocument</code></a> object
 and sent as input in a signature operation. By using a PDF signature page whose structure and constitution is well
 known it is easy to include a PDF signature image into any PDF document being signed.
 </p>
 <p>
 Also, since a PDF document can be signed several times, using a PDF signature page it is easy to include signature
 images for all signatures of the document.
 </p>
 <p>
 The <code>preparePdfSignaturePage</code> method should invoked before each call to
 <a href="SignServiceIntegrationService.html#createSignRequest(se.idsec.signservice.integration.SignRequestInput)"><code>SignServiceIntegrationService.createSignRequest(SignRequestInput)</code></a> where PDF documents with PDF signature
 pages is to be used. If a PDF document is to be signed is signed more than once and the PDF signature page supports
 several signature images, no new PDF signature page is added. Instead, the <code>preparePdfSignaturePage</code> method
 calculates where in the already existing PDF signature page the next signature image will be inserted.
 </p>
 <p>
 If the policy states that PDF/A constistence checks should be done (see
 <a href="document/pdf/PdfPrepareSettings.html#isEnforcePdfaConsistency()"><code>PdfPrepareSettings.isEnforcePdfaConsistency()</code></a>, the method will enforce that sign pages are PDF/A if the
 document being signed is PDF/A.
 </p>
 <b>Fixing PDF Issues</b>
 <p>
 Depending on the settings of the profile configuration's <a href="document/pdf/PdfPrepareSettings.html" title="class in se.idsec.signservice.integration.document.pdf"><code>PdfPrepareSettings</code></a> the method may adjust the
 document being signed by:
 </p>
 <ul>
   <li>Flattening any present Acroforms from the document.</li>
   <li>Removing the encryption dictionary from the document, if present.</li>
 </ul>
 <b>A note about the returnDocumentReference parameter</b>
 <p>
 If the backend service is running in "stateful" mode, meaning that it maintains a state of ongoing operations
 in the service itself, the processed (prepared) document may be saved in the state, and later be referenced
 in a call to <code>createSignRequest</code>. This way a potentially large document only has to be "uploaded" once.
 </p>
 <p>
 By setting the <code>returnDocumentReference</code> parameter to <code>true</code> the method will not return the
 (potentially updated) document, but instead a reference to it (see <a href="document/pdf/PreparedPdfDocument.html#getPdfDocumentReference()"><code>PreparedPdfDocument.getPdfDocumentReference()</code></a>).
 </p>
 <p>
 In "stateful" more the default value for the <code>returnDocumentReference</code> parameter is <code>true</code>. In stateless
 mode, the value of the parameter is ignored.
 </p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>policy</code> - the policy under which the operation is performed (see <a href="SignRequestInput.html#getPolicy()"><code>SignRequestInput.getPolicy()</code></a>). If
     <code>null</code>, the default policy is used.</dd>
<dd><code>pdfDocument</code> - the contents of the PDF document that is to be prepared</dd>
<dd><code>signaturePagePreferences</code> - the PDF signature page preferences (if <code>null</code>, no sign page is used)</dd>
<dd><code>returnDocumentReference</code> - whether to use document references (see above)</dd>
<dd><code>callerId</code> - the identity for the calling entity (only needed if the implementation is a stand-alone service
     running in stateful mode)</dd>
<dt>Returns:</dt>
<dd>a PreparedPdfDocument object containing the modified PDF document (if a sign page was added) and the
     VisiblePdfSignatureRequirement telling how a signature image should be added</dd>
<dt>Throws:</dt>
<dd><code><a href="core/error/InputValidationException.html" title="class in se.idsec.signservice.integration.core.error">InputValidationException</a></code> - for input validation errors</dd>
<dd><code><a href="document/pdf/PdfSignaturePageFullException.html" title="class in se.idsec.signservice.integration.document.pdf">PdfSignaturePageFullException</a></code> - if the PDF document contains more signatures than there is room for in
     the PDF signature page (and <a href="document/pdf/PdfSignaturePagePreferences.html#isFailWhenSignPageFull()"><code>PdfSignaturePagePreferences.isFailWhenSignPageFull()</code></a> evaluates to true)</dd>
<dd><code><a href="document/pdf/PdfAConsistencyCheckException.html" title="class in se.idsec.signservice.integration.document.pdf">PdfAConsistencyCheckException</a></code> - if the policy is configured to enforce PDF/A consistency, and a sign page
     that is not PDF/A is attempted to be added to a PDF/A document</dd>
<dd><code><a href="document/pdf/PdfContainsAcroformException.html" title="class in se.idsec.signservice.integration.document.pdf">PdfContainsAcroformException</a></code> - the PDF document contains an Acroform (and policy is not configured to
     flatten such forms)</dd>
<dd><code><a href="document/pdf/PdfContainsEncryptionDictionaryException.html" title="class in se.idsec.signservice.integration.document.pdf">PdfContainsEncryptionDictionaryException</a></code> - the PDF document contains an encryption dictionary (and policy
     is not configured to remove these)</dd>
<dd><code><a href="core/error/SignServiceIntegrationException.html" title="class in se.idsec.signservice.integration.core.error">SignServiceIntegrationException</a></code> - for other processing errors</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small>Copyright &#169; 2024 <a href="https://www.idsec.se">IDsec Solutions AB</a>. All rights reserved.</small></p>
</footer>
</div>
</div>
</body>
</html>
